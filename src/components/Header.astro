---
import DarkMode from '@/components/DarkMode.astro'
import Menu from '@/icons/variable/Menu.astro'
import X from '@/icons/variable/X.astro'
---

<header
  class="w-full mx-auto max-w-[1000px] md:py-6 px-5 flex items-center justify-between md:animate-fade-in-up"
  transition:persist
>
  <div class="flex justify-between items-center w-full">
    <a
      class="flex items-center text-center ancla-logo hover:drop-shadow-[0_10px_20px_rgba(230,200,25,5)] dark:hover:drop-shadow-[0_10px_20px_rgba(230,200,25,5)] cursor-pointer"
      href="/"
    >
      <img class="size-28 cover img-logo" src="img/LogoNeider.avif" alt="" />
      <img
        class="size-28 cover img-logo-2"
        loading="lazy"
        src="img/JavaScript-logo.avif"
        alt="Imagen del logo"
      />
    </a>

    <!-- Desktop Navigation -->
    <nav
      id="menu"
      class="nav__overlay md:justify-between md:gap-5 tracking-widest z-30 text-xl
    md:text-base bg-black md:py-0 md:static md:bg-transparent
    hidden md:block flex-col md:flex-row gap-2 xl:gap-x-5 animate-jump-in
     lg:text-base text-[#CAA152]"
    >
      <ul class="nav__menu flex flex-col md:flex-row items-center gap-5">
        <li>
          <a
            class="hover:text-[#fbc531] text-white dark:text-[#012029] font-black transition-all duration-300"
            href="/MoreProjects">Proyectos</a
          >
        </li>
        <li>
          <a
            class="hover:text-[#fbc531] text-white dark:text-[#012029] font-extrabold transition-all duration-300"
            href="/#habilidades">Habilidades</a
          >
        </li>
        <li>
          <a
            class="hover:text-[#fbc531] text-white dark:text-[#012029] font-extrabold md:mb-0 transition-all duration-300"
            href="/#contacto">Contacto</a
          >
        </li>
        <li></li>
      </ul>
    </nav>
    <DarkMode
      class=""
      aria-label="Botón para cambiar el modo oscuro"
      id="dark"
      transition:persist
    />
  </div>

  <button aria-label="Abrir menú móvil" id="menuButton" class="button z-[100]">
    <Menu
      class="text-white dark:text-black w-8 transition-all duration-300 md:hidden block -[40px] right-10 z-50"
      aria-label="Boton de abrir menu"
      id="open__hamburguer"
      transition:persist
    />
    <X
      class="text-black dark:text-white fixed w-8 md:hidden block transition-all duration-300 top-[40px] right-10 opacity-0 scale-0 z-50"
      aria-label="Boton de cerrar menu"
      id="close__hamburguer"
      transition:persist
    />
  </button>

  <div
    id="mobileMenu"
    class="fixed inset-0 bg-black/50 backdrop-blur-sm z-40 opacity-0 pointer-events-none transition-all duration-300 md:hidden"
  >
    <nav
      class="absolute top-0 right-0 h-full w-64 max-w-[75vw] bg-white dark:bg-gray-700 shadow-xl transform translate-x-full transition-transform duration-300"
    >
      <div class="flex flex-col p-6 pt-20 h-full">
        <a
          class="text-[#012029] dark:text-white font-black py-3 text-lg hover:text-[#fbc531] transition-colors"
          href="/MoreProjects"
        >
          Proyectos
        </a>
        <a
          class="text-[#012029] dark:text-white font-extrabold py-3 text-lg hover:text-[#fbc531] transition-colors"
          href="/#habilidades"
        >
          Habilidades
        </a>
        <a
          class="text-[#012029] dark:text-white font-extrabold py-3 text-lg hover:text-[#fbc531] transition-colors"
          href="/#contacto"
        >
          Contacto
        </a>
      </div>
    </nav>
  </div>
</header>

<style>
  .fijada {
    position: fixed;
  }

  @media screen and (width >= 768px) {
    .fijada {
      position: relative;
    }
    nav {
      animation: none;
    }
    nav a {
      position: relative;
    }
    nav a:hover {
      text-shadow: 0px 0px 15px rgb(5, 70, 0, 0.7);
    }

    nav a::after {
      content: '';
      position: absolute;
      background-color: #fbc531;
      height: 3px;
      width: 0%;
      left: 0;
      bottom: -12px;
      transition: width 0.5s ease-out;
      border-radius: 20px;
    }
    nav a:hover::after {
      width: 100%;
    }
    nav a::before {
      content: '';
      position: absolute;
      background-color: #fbc531;
      height: 3px;
      width: 0%;
      right: 0;
      top: -8px;
      transition: width 0.5s ease-out;
      border-radius: 20px;
    }
    nav a:hover::before {
      width: 100%;
    }
  }

  @media screen and (width < 768px) {
    nav ul a {
      color: #012029;
    }

    #dark {
      background-color: #012029;
    }

    .nav__overlay {
      background-color: rgba(0, 0, 0, 0.4);
      position: fixed;
      inset: 0;
      transition: opacity 0.3s ease;
      max-height: 0;
    }

    .nav__overlay--show {
      max-height: 500px;
    }

    .nav__menu {
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      background: rgba(252, 252, 252, 0.7);

      max-width: 250px;
      max-height: 500px;
      width: 65%;
      overflow: auto;
      padding: 120px 0;
      box-shadow: 0px 0px 80px rgba(1, 32, 41, 1);
    }
  }
  img {
    transition: all 0.3s ease-in-out;
  }
  .ancla-logo .img-logo-2 {
    transition: transform 0.3s ease-in-out;
    transform: scale(0);
  }

  .ancla-logo:hover .img-logo-2 {
    transform: scale(1);
  }

  .ancla-logo .img-logo {
    transition: all 0.3s ease-in-out;
    position: absolute;
  }

  .ancla-logo:hover .img-logo {
    transform: scale(0);
  }

  /* Mobile menu animations */
  .mobile-menu-open {
    opacity: 1 !important;
    pointer-events: auto !important;
  }
  .mobile-menu-open nav {
    transform: translateX(0) !important;
  }
  .mobile-button-open {
    opacity: 0 !important;
    scale: 0 !important;
  }
  .mobile-button-close {
    opacity: 1 !important;
    scale: 1 !important;
  }
</style>

<script>
  const menu = document.querySelector('#menu')
  const boton = document.querySelector('.button')
  const navLinks = document.querySelectorAll('#menu a')
  const openHamburguer = document.querySelector('#open__hamburguer')
  const closeHamburguer = document.querySelector('#close__hamburguer')
  const mobileMenu = document.querySelector('#mobileMenu')

  function openMenu() {
    mobileMenu.classList.add('mobile-menu-open')
    openHamburguer.classList.add('mobile-button-open')
    closeHamburguer.classList.add('mobile-button-close')
    document.body.style.overflow = 'hidden'
  }
  function closeMenu() {
    mobileMenu.classList.remove('mobile-menu-open')
    openHamburguer.classList.remove('mobile-button-open')
    closeHamburguer.classList.remove('mobile-button-close')
    document.body.style.overflow = ''
  }

  boton.addEventListener('click', () => {
    if (mobileMenu.classList.contains('mobile-menu-open')) {
      closeMenu()
    } else {
      openMenu()
    }
  })
  // Close menu when clicking on links
  navLinks.forEach((link) => {
    link.addEventListener('click', closeMenu)
  })
  // Close menu when clicking on overlay background
  mobileMenu.addEventListener('click', (e) => {
    if (e.target === mobileMenu) {
      closeMenu()
    }
  })
  // Close menu with Escape key
  document.addEventListener('keydown', (e) => {
    if (
      e.key === 'Escape' &&
      mobileMenu.classList.contains('mobile-menu-open')
    ) {
      closeMenu()
    }
  })
</script>
